/* ===== Theme tokens (light/dark) ===== */
:root{
  --wed-bg:#fffaf7; --wed-ink:#232425; --wed-blush:#f6d7d7; --wed-sage:#bfeac4; --wed-champ:#f3e6c4; --wed-gold:#c6a86a;
  --panel-radius:16px; --panel-shadow:0 14px 36px rgba(0,0,0,.14), 0 6px 12px rgba(0,0,0,.06);
  --nav-height:56px;
}
html[data-theme="dark"]{
  --wed-bg:#111513; --wed-ink:#eaefe8; --wed-blush:#4b3d46; --wed-sage:#193a2a; --wed-champ:#2a241a; --wed-gold:#b79a66;
  --panel-shadow:0 18px 40px rgba(0,0,0,.35), 0 6px 14px rgba(0,0,0,.28);
}

/* Panel menu background vars */
html:not([data-theme="dark"]){ --panel-menu-bg:#dff5e1; --panel-menu-border:#bfeac4; }
html[data-theme="dark"]{ --panel-menu-bg:#0f2a21; --panel-menu-border:#1c4b3a; }

/* ===== Global + main background ===== */
body{
  font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans";
  color:var(--wed-ink);
  background-color:var(--wed-bg);
  background-image:url("/assets/lovenote.jpg");
  background-position:center top;
  background-size:cover;
  background-repeat:no-repeat;
  background-attachment:fixed;
}
@media (max-width: 991.98px){ body{ background-attachment:scroll; } }
h1,h2,h3,h4,h5,h6,.display-1,.display-2,.display-3{ font-family:"Cormorant Garamond",Georgia,"Times New Roman",serif; letter-spacing:.2px; font-weight:600; }
body::before, body::after { content:none !important; }

/* ===== Panel Menu (fixed under navbar) ===== */
.w-menu-bar{
  position:fixed; left:0; right:0; top:var(--nav-height);
  background:var(--panel-menu-bg);
  border-bottom:1px solid var(--panel-menu-border);
  z-index:1029;
  backdrop-filter:saturate(130%) blur(6px);
  transition:padding .18s ease, box-shadow .18s ease, height .18s ease;
  background-image:
    linear-gradient(180deg, color-mix(in oklab, var(--panel-menu-bg) 90%, #fff0), var(--panel-menu-bg)),
    repeating-linear-gradient(135deg, rgba(255,255,255,.12) 0 2px, rgba(255,255,255,0) 2px 6px);
  box-shadow:0 6px 14px rgba(0,0,0,.06), inset 0 -1px 0 rgba(0,0,0,.08);
}
.w-menu-bar.compact{ box-shadow:0 4px 10px rgba(0,0,0,.08), inset 0 -1px 0 rgba(0,0,0,.12); }
#panel-menu .container{ transition:padding .18s ease, height .18s ease; }
.w-menu-bar.compact #panel-menu .container{ padding-top:.25rem!important; padding-bottom:.25rem!important; }
.w-stage-spacer{ height:var(--panel-menu-height, 60px); }

/* ===== Menu buttons ===== */
.pm-btn{
  --radius:999px;
  padding:.35rem .7rem; border-radius:var(--radius);
  font-size:.9rem; line-height:1.1;
  border:1px solid var(--bs-primary); color:var(--bs-primary); background:transparent;
  transition:background .2s ease, color .2s ease, border-color .2s ease, box-shadow .2s ease, transform .06s ease;
}
.pm-btn:hover{ background:color-mix(in oklab, var(--bs-primary) 14%, transparent); }
.pm-btn:active{ transform:scale(.98); }
.pm-btn.active{
  background:var(--pm-color, var(--bs-primary)); color:var(--bs-body-bg); border-color:var(--pm-color, var(--bs-primary));
  box-shadow:0 0 0 1px color-mix(in oklab, var(--pm-color) 60%, transparent), 0 6px 14px color-mix(in oklab, var(--pm-color) 16%, transparent);
  position:relative;
}
.pm-btn.active::before{ content:""; position:absolute; left:10%; right:10%; top:-3px; height:2px; border-radius:2px; background:var(--wed-gold); opacity:.9; }
html[data-theme="dark"] .pm-btn.active{ filter:brightness(1.05) saturate(.95); }

/* ===== Panels (structure) ===== */
.w-panel{
  position:fixed; top:calc(var(--nav-height) + var(--panel-menu-height, 60px)); bottom:12px; left:12px;
  width:min(50vw, 920px);
  background-color:transparent;
  border:1px solid var(--bs-border-color); box-shadow:var(--panel-shadow); z-index:1030; overflow:hidden;
  border-radius:var(--panel-radius);
  transform:translateX(calc(-100% - 12px)); transition:transform .42s cubic-bezier(.22,.61,.36,1), box-shadow .2s ease, opacity .2s ease;
  opacity:.98;
}
.w-panel.right{ right:12px; left:auto; transform:translateX(calc(100% + 12px)); }
.w-panel.open{ transform:translateX(0); }

/* Solid, sticky header (single source of truth) */
.w-panel .w-head{
  position:sticky; top:0; z-index:1;
  background:var(--bs-body-bg) !important;
  border-bottom:2px solid var(--panel-accent, var(--bs-primary));
  box-shadow:0 1px 0 rgba(0,0,0,.06);
}
.w-panel .w-body{ padding:1rem 1.25rem 2rem; height:100%; overflow:auto; scrollbar-gutter:stable both-edges; }

/* ===== Panel paper backgrounds ===== */
html:not([data-theme="dark"]){ --panel-overlay:rgba(255,255,255,.38); }
html[data-theme="dark"]{ --panel-overlay:rgba(0,0,0,.25); }
.w-panel.left{
  background-image:linear-gradient(var(--panel-overlay), var(--panel-overlay)), url("/assets/notepad-left.jpg");
  background-repeat:no-repeat; background-size:cover; background-position:center top;
}
.w-panel.right{
  background-image:linear-gradient(var(--panel-overlay), var(--panel-overlay)), url("/assets/notepad-right.jpg");
  background-repeat:no-repeat; background-size:cover; background-position:center top;
}

/* Masonry helpers */
.masonry{ column-count:2; column-gap:.75rem; }
@media (min-width:576px){ .masonry{ column-count:3; } }
@media (min-width:992px){ .masonry{ column-count:4; } }
.masonry .m-item{ break-inside:avoid; margin-bottom:.75rem; }
.masonry .card img{ width:100%; height:auto; display:block; }
.muted{ color:var(--bs-secondary-color); }

/* Mobile full-width */
@media (max-width:991.98px){ .w-panel{ left:8px; right:8px; width:calc(100vw - 16px); } .w-panel.right{ right:8px; } }

/* ===== Image labels + delete btn ===== */
.img-label{ font-size:.85rem; padding:.125rem .375rem; border-radius:6px; background:rgba(255,255,255,.85); color:#222; }
html[data-theme="dark"] .img-label{ background:rgba(0,0,0,.6); color:#fff; }

.photo-card{ position:relative; }
.img-del-form{ position:absolute; top:.5rem; right:.5rem; margin:0; }
.btn-img-del{
  width:26px; height:26px; border:0; border-radius:8px;
  background:rgba(0,0,0,.18); color:#fff; line-height:1;
  display:flex; align-items:center; justify-content:center;
  opacity:.7; transition:opacity .15s ease, background .15s ease;
}
.btn-img-del:hover{ opacity:1; background:rgba(0,0,0,.28); }
html[data-theme="dark"] .btn-img-del{ background:rgba(255,255,255,.18); }
html[data-theme="dark"] .btn-img-del:hover{ background:rgba(255,255,255,.28); }

/* ===== Boards tab bar ===== */
.board-tabs{
  --count: var(--tab-count, 6);
  position:relative; display:grid;
  grid-template-columns:repeat(var(--count), minmax(0, 1fr));
  background:var(--bs-body-bg);
  border:1px solid var(--bs-border-color); border-radius:10px; overflow:hidden; margin-bottom:.75rem;
}
.board-tabs .tab{
  border:0; background:transparent; padding:.42rem .4rem; text-align:center;
  color:var(--bs-secondary-color); font-weight:500; font-size:.92rem; line-height:1.15; min-width:0;
}
.board-tabs .tab .label{ display:inline-block; max-width:100%; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.board-tabs .tab:hover{ background:color-mix(in oklab, var(--bs-primary) 7%, transparent); }
.board-tabs .tab.active{ color:var(--bs-body-color); }
.board-tabs .tab-indicator{
  position:absolute; left:0; bottom:0; height:2px; width:calc(100% / var(--count));
  background:var(--panel-accent, var(--bs-primary)); transform:translateX(calc(var(--active-index, 0) * 100%));
  transition:transform .25s ease; z-index:1;
}

/* ===== Success pulses (title + center) ===== */
.w-check{ display:inline-flex; width:22px; height:22px; margin-left:.5rem; opacity:0; transform:scale(.85); vertical-align:middle; filter:drop-shadow(0 1px 1px rgba(0,0,0,.12)); }
.w-check svg{ width:100%; height:100%; }
.w-check .w-circ,.w-check .w-path{ fill:none; stroke-linecap:round; stroke-linejoin:round; stroke:var(--bs-success); }
.w-check.show{ animation:w-check-pop .18s ease-out forwards; }
.w-check .w-circ{ stroke-dasharray:160; stroke-dashoffset:160; }
.w-check .w-path{ stroke-dasharray:36; stroke-dashoffset:36; }
.w-check.show .w-circ{ animation:w-check-draw .36s .02s ease forwards; }
.w-check.show .w-path{ animation:w-check-draw .42s .12s ease forwards; }
.w-check.fade{ animation:w-check-fade .22s ease-in forwards; }
@keyframes w-check-pop{ to{ opacity:1; transform:scale(1); } }
@keyframes w-check-draw{ to{ stroke-dashoffset:0; } }
@keyframes w-check-fade{ to{ opacity:0; transform:scale(.9); } }

.panel-pulse{
  position:absolute; left:50%; top:50%; transform:translate(-50%,-50%) scale(.9);
  pointer-events:none; opacity:0; width:72px; height:72px; filter:drop-shadow(0 6px 16px rgba(0,0,0,.18)); z-index:3;
}
.panel-pulse svg{ width:100%; height:100%; }
.panel-pulse .pp-circ,.panel-pulse .pp-path{ fill:none; stroke-linecap:round; stroke-linejoin:round; stroke:var(--bs-success); }
.panel-pulse.show{ animation:pp-pop .16s ease-out forwards; }
.panel-pulse .pp-circ{ stroke-dasharray:220; stroke-dashoffset:220; }
.panel-pulse .pp-path{ stroke-dasharray:60; stroke-dashoffset:60; }
.panel-pulse.show .pp-circ{ animation:pp-draw .32s .04s ease forwards; }
.panel-pulse.show .pp-path{ animation:pp-draw .36s .14s ease forwards; }
.panel-pulse.fade{ animation:pp-fade .28s ease-in forwards; }
@keyframes pp-pop{ to{ opacity:1; transform:translate(-50%,-50%) scale(1); } }
@keyframes pp-draw{ to{ stroke-dashoffset:0; } }
@keyframes pp-fade{ to{ opacity:0; transform:translate(-50%,-50%) scale(.96); } }

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  .w-panel, .pm-btn, .w-menu-bar, #panel-menu .container, .w-check, .panel-pulse { transition:none!important; animation:none!important; opacity:1!important; }
}

/* --- Soft press for all buttons --- */
.btn { transition: transform .06s ease, box-shadow .18s ease; }
.btn:active:not(:disabled) { transform: translateY(.5px) scale(.98); }

/* --- Ripple for primary buttons inside panels --- */
.w-panel .btn-primary { position: relative; overflow: hidden; }
.w-panel .btn-primary { --ripple-color: color-mix(in oklab, var(--bs-primary) 65%, white); }

.w-panel .btn-primary .ripple {
  position: absolute; border-radius: 50%; pointer-events: none;
  background: var(--ripple-color);
  opacity: .35; transform: scale(0);
  animation: w-ripple .6s ease-out forwards;
  mix-blend-mode: multiply;
}

@keyframes w-ripple {
  50% { transform: scale(1); opacity: .28; }
  100% { transform: scale(1.15); opacity: 0; }
}

/* Reduced motion: keep the press but disable ripples */
@media (prefers-reduced-motion: reduce){
  .w-panel .btn-primary .ripple { animation: none !important; opacity: .15; transform: none; }
}

/* -- Graceful delete animation -- */
.vanish {
  opacity: 0;
  transform: translateY(4px) scale(.98);
  transition: opacity .18s ease, transform .18s ease;
}

/* Star overlay on cards */
.btn-star-toggle{
  position:absolute; top:.5rem; left:.5rem;
  width:28px; height:28px; border:0; border-radius:8px;
  display:flex; align-items:center; justify-content:center;
  background:rgba(255,255,255,.85); color:#8a6a00;
  transition:background .15s ease, transform .06s ease, opacity .15s ease;
  opacity:.9;
}
.btn-star-toggle:hover{ background:#fff; opacity:1; }
.btn-star-toggle:active{ transform:scale(.95); }
.btn-star-toggle.active{ color:#b8860b; }
html[data-theme="dark"] .btn-star-toggle{ background:rgba(0,0,0,.5); color:#ffdd77; }
html[data-theme="dark"] .btn-star-toggle:hover{ background:rgba(0,0,0,.65); }

/* Toolbar spacing */
.boards-toolbar .btn{ line-height:1; }
